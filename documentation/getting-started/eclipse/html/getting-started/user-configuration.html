<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>2.8.1. User Configuration</title>
<link rel="stylesheet" type="text/css" href="../book.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.76.1">
<link rel="home" href="index.html" title="Getting Started With Yocto Project">
<link rel="up" href="development-concepts.html" title="2.8. Development Concepts">
<link rel="prev" href="development-concepts.html" title="2.8. Development Concepts">
<link rel="next" href="metadata-machine-configuration-and-policy-configuration.html" title="2.8.2. Metadata, Machine Configuration, and Policy Configuration">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section" title="2.8.1. User Configuration">
<div class="titlepage"><div><div><h3 class="title">
<a name="user-configuration"></a>2.8.1. User Configuration</h3></div></div></div>
<p>
            User configuration helps define the build.
            Through user configuration, you can tell BitBake the
            target architecture for which you are building the image,
            where to store downloaded source, and other build properties.
        </p>
<p>
            The following figure shows an expanded representation of the
            "User Configuration" box of the
            <a class="link" href="development-concepts.html#general-yocto-environment-figure">general Yocto Project Development Environment figure</a>:
        </p>
<p>
            </p>
<table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="720"><tr style="height: 405px"><td align="center"><img src="figures/user-configuration.png" align="middle" height="405"></td></tr></table>
<p>
        </p>
<p>
            BitBake needs some basic configuration files in order to complete
            a build.
            These files are <code class="filename">*.conf</code> files.
            The minimally necessary ones reside as example files in the
            <a class="link" href="../ref-manual/source-directory.html" target="_self">Source Directory</a>.
            For simplicity, this section refers to the Source Directory as
            the "Poky Directory."
        </p>
<p>
            When you clone the <code class="filename">poky</code> Git repository or you
            download and unpack a Yocto Project release, you can set up the
            Source Directory to be named anything you want.
            For this discussion, the cloned repository uses the default
            name <code class="filename">poky</code>.
            </p>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
                The Poky repository is primarily an aggregation of existing
                repositories.
                It is not a canonical upstream source.
            </div>
<p>
        </p>
<p>
            The <code class="filename">meta-poky</code> layer inside Poky contains
            a <code class="filename">conf</code> directory that has example
            configuration files.
            These example files are used as a basis for creating actual
            configuration files when you source the build environment
            script
            (i.e.
            <a class="link" href="../ref-manual/structure-core-script.html" target="_self"><code class="filename">oe-init-build-env</code></a>).
        </p>
<p>
            Sourcing the build environment script creates a
            <a class="link" href="../ref-manual/build-directory.html" target="_self">Build Directory</a>
            if one does not already exist.
            BitBake uses the Build Directory for all its work during builds.
            The Build Directory has a <code class="filename">conf</code> directory that
            contains default versions of your <code class="filename">local.conf</code>
            and <code class="filename">bblayers.conf</code> configuration files.
            These default configuration files are created only if versions
            do not already exist in the Build Directory at the time you
            source the build environment setup script.
        </p>
<p>
            Because the Poky repository is fundamentally an aggregation of
            existing repositories, some users might be familiar with running
            the <code class="filename">oe-init-build-env</code> script in the context
            of separate OpenEmbedded-Core and BitBake repositories rather than a
            single Poky repository.
            This discussion assumes the script is executed from within a cloned
            or unpacked version of Poky.
        </p>
<p>
            Depending on where the script is sourced, different sub-scripts
            are called to set up the Build Directory (Yocto or OpenEmbedded).
            Specifically, the script
            <code class="filename">scripts/oe-setup-builddir</code> inside the
            poky directory sets up the Build Directory and seeds the directory
            (if necessary) with configuration files appropriate for the
            Yocto Project development environment.
            </p>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
                The <code class="filename">scripts/oe-setup-builddir</code> script
                uses the <code class="filename">$TEMPLATECONF</code> variable to
                determine which sample configuration files to locate.
            </div>
<p>
        </p>
<p>
            The <code class="filename">local.conf</code> file provides many
            basic variables that define a build environment.
            Here is a list of a few.
            To see the default configurations in a <code class="filename">local.conf</code>
            file created by the build environment script, see the
            <code class="filename">local.conf.sample</code> in the
            <code class="filename">meta-poky</code> layer:
            </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p><span class="emphasis"><em>Parallelism Options:</em></span>
                    Controlled by the
                    <a class="link" href="../ref-manual/var-BB_NUMBER_THREADS.html" target="_self"><code class="filename">BB_NUMBER_THREADS</code></a>,
                    <a class="link" href="../ref-manual/var-PARALLEL_MAKE.html" target="_self"><code class="filename">PARALLEL_MAKE</code></a>,
                    and
                    <a class="link" href="../bitbake-user-manual/var-BB_NUMBER_PARSE_THREADS.html" target="_self"><code class="filename">BB_NUMBER_PARSE_THREADS</code></a>
                    variables.</p></li>
<li class="listitem"><p><span class="emphasis"><em>Target Machine Selection:</em></span>
                    Controlled by the
                    <a class="link" href="../ref-manual/var-MACHINE.html" target="_self"><code class="filename">MACHINE</code></a>
                    variable.</p></li>
<li class="listitem"><p><span class="emphasis"><em>Download Directory:</em></span>
                    Controlled by the
                    <a class="link" href="../ref-manual/var-DL_DIR.html" target="_self"><code class="filename">DL_DIR</code></a>
                    variable.</p></li>
<li class="listitem"><p><span class="emphasis"><em>Shared State Directory:</em></span>
                    Controlled by the
                    <a class="link" href="../ref-manual/var-SSTATE_DIR.html" target="_self"><code class="filename">SSTATE_DIR</code></a>
                    variable.</p></li>
<li class="listitem"><p><span class="emphasis"><em>Build Output:</em></span>
                    Controlled by the
                    <a class="link" href="../ref-manual/var-TMPDIR.html" target="_self"><code class="filename">TMPDIR</code></a>
                    variable.</p></li>
</ul></div>
<p>
            </p>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
                Configurations set in the <code class="filename">conf/local.conf</code>
                file can also be set in the
                <code class="filename">conf/site.conf</code> and
                <code class="filename">conf/auto.conf</code> configuration files.
            </div>
<p>
        </p>
<p>
            The <code class="filename">bblayers.conf</code> file tells BitBake what
            layers you want considered during the build.
            By default, the layers listed in this file include layers
            minimally needed by the build system.
            However, you must manually add any custom layers you have created.
            You can find more information on working with the
            <code class="filename">bblayers.conf</code> file in the
            "<a class="link" href="../dev-manual/enabling-your-layer.html" target="_self">Enabling Your Layer</a>"
            section in the Yocto Project Development Tasks Manual.
        </p>
<p>
            The files <code class="filename">site.conf</code> and
            <code class="filename">auto.conf</code> are not created by the environment
            initialization script.
            If you want the <code class="filename">site.conf</code> file, you need to
            create that yourself.
            The <code class="filename">auto.conf</code> file is typically created by
            an autobuilder:
            </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
<p><span class="emphasis"><em><code class="filename">site.conf</code>:</em></span>
                    You can use the <code class="filename">conf/site.conf</code>
                    configuration file to configure multiple build directories.
                    For example, suppose you had several build environments and
                    they shared some common features.
                    You can set these default build properties here.
                    A good example is perhaps the packaging format to use
                    through the
                    <a class="link" href="../ref-manual/var-PACKAGE_CLASSES.html" target="_self"><code class="filename">PACKAGE_CLASSES</code></a>
                    variable.</p>
<p>One useful scenario for using the
                    <code class="filename">conf/site.conf</code> file is to extend your
                    <a class="link" href="../ref-manual/var-BBPATH.html" target="_self"><code class="filename">BBPATH</code></a>
                    variable to include the path to a
                    <code class="filename">conf/site.conf</code>.
                    Then, when BitBake looks for Metadata using
                    <code class="filename">BBPATH</code>, it finds the
                    <code class="filename">conf/site.conf</code> file and applies your
                    common configurations found in the file.
                    To override configurations in a particular build directory,
                    alter the similar configurations within that build
                    directory's <code class="filename">conf/local.conf</code> file.
                    </p>
</li>
<li class="listitem"><p><span class="emphasis"><em><code class="filename">auto.conf</code>:</em></span>
                    The file is usually created and written to by
                    an autobuilder.
                    The settings put into the file are typically the same as
                    you would find in the <code class="filename">conf/local.conf</code>
                    or the <code class="filename">conf/site.conf</code> files.
                    </p></li>
</ul></div>
<p>
        </p>
<p>
            You can edit all configuration files to further define
            any particular build environment.
            This process is represented by the "User Configuration Edits"
            box in the figure.
        </p>
<p>
            When you launch your build with the
            <code class="filename">bitbake <em class="replaceable"><code>target</code></em></code>
            command, BitBake sorts out the configurations to ultimately
            define your build environment.
            It is important to understand that the OpenEmbedded build system
            reads the configuration files in a specific order:
            <code class="filename">site.conf</code>, <code class="filename">auto.conf</code>,
            and <code class="filename">local.conf</code>.
            And, the build system applies the normal assignment statement
            rules.
            Because the files are parsed in a specific order, variable
            assignments for the same variable could be affected.
            For example, if the <code class="filename">auto.conf</code> file and
            the <code class="filename">local.conf</code> set
            <em class="replaceable"><code>variable1</code></em> to different values, because
            the build system parses <code class="filename">local.conf</code> after
            <code class="filename">auto.conf</code>,
            <em class="replaceable"><code>variable1</code></em> is assigned the value from
            the <code class="filename">local.conf</code> file.
        </p>
</div></body>
</html>
